--- 01 CREA O MODIFICA SP insertar Rol

CREATE OR ALTER PROCEDURE insertarRol
	@Nombre VARCHAR(60),    	
	@Descripcion VARCHAR(30)
AS
BEGIN
	INSERT INTO Administración.Rol(Nombre, Descripcion) VALUES(
		@Nombre,
		@Descripcion
	);
END;

--- 02 CREA O MODIFICA SP para modificar Rol 

CREATE OR ALTER PROCEDURE modificarRol
	@ID_Rol INT,
	@Nombre VARCHAR(60) = NULL,    	
	@Descripcion VARCHAR(30) = NULL
AS
BEGIN
	UPDATE Administración.Rol 
	SET
		Nombre = ISNULL(@Nombre, Nombre), 
		Descripcion = ISNULL(@Descripcion, Descripcion)
	WHERE ID_Rol = @ID_Rol
END;

--- 03 CREA O MODIFICA SP para eliminar Rol

CREATE OR ALTER PROCEDURE eliminarRol
	@ID_Rol INT
AS
BEGIN
	DELETE
	FROM Administración.Rol
	WHERE ID_Rol = @ID_Rol
END;

--- 04 CREACION DE PROCEDURE ingresarUsuario

CREATE OR ALTER PROCEDURE ingresarUsuario
    	@DNI int,
    	@Nombre VARCHAR(50),
    	@Apellido VARCHAR(50),
    	@Email VARCHAR(50),
    	@TelefonoContacto char(12),
    	@FechaNacimiento DATE,
    	@Contrasenia VARCHAR(100),
    	@ID_Rol INT
AS
BEGIN
	INSERT INTO Administracion.Usuario(DNI, Nombre, Apellido, Email, TelefonoContacto, FechaNacimiento, Contrasenia, ID_Rol) VALUES(
		@DNI,
    		@Nombre,
    		@Apellido,
    		@Email,
    		@TelefonoContacto,
    		@FechaNacimiento,
    		@Contrasenia,
    		@ID_Rol
	)
END;

--- 05 CREACION DE PROCEDURE modificarUsuario

CREATE OR ALTER PROCEDURE modificarUsuario
	@ID_Usuario,
	@DNI int = NULL,
    	@Nombre VARCHAR(50) = NULL,
    	@Apellido VARCHAR(50) = NULL,
    	@Email VARCHAR(50) = NULL,
    	@TelefonoContacto char(12) = NULL,
    	@FechaNacimiento DATE = NULL,
    	@Contrasenia VARCHAR(100) = NULL,
    	@ID_Rol INT = NULL
AS
BEGIN
	UPDATE Administración.Usuario SET
		DNI int = ISNULL(@DNI, DNI),
    		Nombre = ISNULL(@Nombre, Nombre),
    		Apellido = ISNULL(@Apellido, Apellido),
    		Email = ISNULL(@Email,Email),
    		TelefonoContacto = ISNULL(@TelefonoContacto, TelefonoContacto),
    		FechaNacimiento = ISNULL(@FechaNacimiento, FechaNacimiento),
    		Contrasenia = ISNULL(@Contrasenia, Contrasenia),
    		@ID_Rol = ISNULL(@ID_Rol, ID_Rol)
	WHERE ID_Usuario = @ID_Usuario
END;

--- 06 CREACION DE PROCEDURE eliminarUsuario

CREATE OR ALTER PROCEDURE eliminarUsuario
	@ID_Usuario INT	
BEGIN
	DELETE
	FROM Administración.Usuario
	WHERE ID_Usuario = @ID_Usuario
END;

--- 07 CREACION PROCEDURE ingresarGrupoFamiliar
	
CREATE OR ALTER PROCEDURE ingresarGrupoFamiliar
	@Tamaño INT,
	@Nombre VARCHAR(100),
AS
BEGIN	
	INSERT INTO Personas.GrupoFamiliar(Tamaño, Nombre) VALUES(
        	Tamaño = @Tamaño,
		Nombre = @Nombre
END;

--- 08 CREACION PROCEDURE modificarGrupoFamiliar
	
CREATE OR ALTER PROCEDURE modificarGrupoFamiliar
	@ID_GrupoFamiliar INT,
	@Tamaño INT = NULL,
	@Nombre VARCHAR(100) = NULL
AS
BEGIN
	UPDATE Personas.GrupoFamiliar(Tamaño, Nombre) SET
		Tamaño = ISNULL(@Tamaño,Tamaño),
		Nombre = ISNULL(@Nombre, Nombre)
	WHERE ID_GrupoFamiliar = @ID_GrupoFamiliar
END;

--- 09 CREACION PROCEDURE eliminarGrupoFamiliar
	@ID_GrupoFamiliar INT
AS
BEGIN
	DELETE
	FROM Personas.GrupoFamiliar
	WHERE ID_GrupoFamiliar = @ID_GrupoFamiliar
END;

--- 10 CREACION PROCEDURE ingresarCategoria

CREATE OR ALTER PROCEDURE ingresarCategoria
	@Descripcion VARCHAR(100),
	@Importe DECIMAL(10,2)
AS
BEGIN
	INSERT INTO Personas.Categoria(Descripción, Importe) VALUES(
		@Descripcion,
		@Importe
	)
END;

--- 11 CREACION PROCEDURE modificarCategoria
	
CREATE OR ALTER PROCEDURE modificarCategoria	
	@ID_Categoria INT = NULL,
	@Descripcion VARCHAR(100) = NULL,
	@Importe DECIMAL(10,2) = NULL
AS
BEGIN
	UPDATE Personas.Categoria(Descripción, Importe) SET
		Descripción = ISNULL(@Descripcion, Descripción),
		Importe = ISNULL(@Importe, Importe)
	WHERE ID_Categoria = @ID_Categoria
END;

--- 12 CREACION PROCEDURE eliminarCategoria
	@ID_Categoria INT
AS
BEGIN
	DELETE
	FROM Personas.Categoria
	WHERE ID_Categoria = @ID_Categoria
END;

--- 13 CREACION PROCEDURE ingresarSocio

CREATE OR ALTER PROCEDURE ingresarSocio
	@ID_Socio INT,
	@TelefonoEmergencia CHAR(12),
	@ObraSocial VARCHAR(50),
	@NroSocioObraSocial INT,
	@ID_Categoria INT,
	@ID_GrupoFamiliar INT,
AS
BEGIN
	INSERT INTO Personas.Socio(ID_Socio, TelefonoEmergencia, ObraSocial, NroObraSocial, ID_Categoriam ID_GrupoFamiliar) VALUES(
		@ID_Socio,
		@TelefonoEmergencia,
		@ObraSocial,
		@NroSocioObraSocial,
		@ID_Categoria,
		@ID_GrupoFamiliar
	)
END;

--- 14 CREACION PROCEDURE modificarSocio

CREATE OR ALTER PROCEDURE modificarSocio
	@ID_Socio INT,
	@TelefonoEmergencia CHAR(12) = NULL,
	@ObraSocial VARCHAR(50) = NULL,
	@NroSocioObraSocial INT = NULL,
	@ID_Categoria INT = NULL,
	@ID_GrupoFamiliar INT = NULL,
AS
BEGIN
	UPDATE Personas.Socio(TelefonoEmergencia, ObraSocial, NroSocioObraSocial, ID_Categoria, ID_GrupoFamiliar) SET
		TelefonoEmergencia = ISNULL(@TelefonoEmergencia, TelefonoEmergencia),
		ObraSocial = ISNULL(@ObraSocial, ObraSocial),
		NroSocioObraSocial = ISNULL(@NroSocioObraSocial, NroSocioObraSocial),
		ID_Categoria = ISNULL(@ID_Categoria, ID_Categoria),
		ID_GrupoFamiliar = ISNULL(@ID_GrupoFamiliar, ID_GrupoFamiliar)
	WHERE ID_Socio = @ID_Socio
END;

--- 15 CREACION PROCEDURE eliminarSocio

CREATE OR ALTER PROCEDURE eliminarSocio
	@ID_Socio INT
AS
BEGIN
	DELETE
	FROM Personas.Socio
	WHERE ID_Socio = @ID_Socio
END;

--- 16 CREACION PROCEDURE ingresarProfesor

CREATE OR ALTER PROCEDURE ingresarProfesor
	@DNI INT,
	@Especialidad VARCHAR(30),
	@Nombre VARCHAR(50),
    @Apellido VARCHAR(50),
    @Email VARCHAR(50),
    @TelefonoContacto CHAR(12)
AS
BEGIN
	INSERT INTO Personas.Profesor(DNI, Especialidad, Nombre, Apellido, Email, TelefonoContacto) VALUES(
		@DNI,
		@Especialidad,
		@Nombre,
    		@Apellido,
    		@Email,
    		@TelefonoContacto
	)
END;

--- 17 CREACION PROCEDURE modificarProfesor

CREATE OR ALTER PROCEDURE modificarProfesor
	@ID_Profesor INT = NULL,
	@DNI INT = NULL,
	@Especialidad VARCHAR(30) = NULL,
	@Nombre VARCHAR(50) = NULL,
    	@Apellido VARCHAR(50) = NULL,
    	@Email VARCHAR(50) = NULL,
    	@TelefonoContacto CHAR(12) = NULL
AS
BEGIN
	UPDATE Personas.Profesor(DNI, Especialidad, Nombre, Apellido, Email, TelefonoContacto) SET
		DNI = ISNULL(@DNI, DNI),
		Especialidad = ISNULL(@Especialidad, Especialidad),
		Nombre = ISNULL(@Nombre, Nombre),
		Apellido = ISNULL(@Apellido, Apellido),
		Email = ISNULL(@Email, Email),
		TelefonoContacto = ISNULL(@TelefonoContacto, TelefonoContacto)
	WHERE ID_PRofesor = @ID_Profesor
END;

--- 18 CREACION PROCEDURE eliminarProfesor
	@ID_Profesor INT
AS
BEGIN
	DELETE
	FROM Personas.Profesor
	WHERE ID_Profesor = @ID_Profesor
END;
--- 19 CREACION PROCEDURE ingresarCuenta

CREATE OR ALTER PROCEDURE ingresarCuenta
		@ID_Socio INT,
		@NroCuenta INT,
        @FechaAlta DATE,
    	@FechaBaja DATE,
    	@Debito DECIMAL(10, 2),
    	@Credito DECIMAL(10, 2),
		@Saldo DECIMAL(10, 2)
BEGIN
AS	
	INSERT INTO Facturacion.Cuenta(ID_Socio, NroCuenta, FechaAlta, FechaBaja, Debito, Credito, Saldo) VALUES(
		@ID_Socio,
		@NroCuenta,
		@FechaAlta,
		@FechaBaja,
		@Debito,
		@Credito,
		@Saldo
	)
END;

--- 20 CREACION PROCEDURE modificarCuenta

CREATE OR ALTER PROCEDURE modificarCuenta
		@ID_Socio INT = NULL,
		@NroCuenta INT = NULL,
        @FechaAlta DATE = NULL,
    	@FechaBaja DATE = NULL,
    	@Debito DECIMAL(10, 2) = NULL,
    	@Credito DECIMAL(10, 2) = NULL,
		@Saldo DECIMAL(10, 2) = NULL
AS
BEGIN
	UPDATE Facturacion.Cuenta(IDSocio, NroCuenta, FechaAlta, FechaBaja, Debito, Credito, Saldo) SET
		@NroCuenta = ISNULL(@NroCuenta, NroCuenta),
        @FechaAlta = ISNULL(@FechaAlta, FechaAlta),
    	@FechaBaja = ISNULL(@FechaBaja, FechaBaja),
    	@Debito = ISNULL(@Debito, Debito),
    	@Credito = ISNULL(@Credito, Credito),
		@Saldo = ISNULL(@Saldo, Saldo)
	WHERE ID_Socio = @ID_Socio
END;

--- 21 CREACION PROCEDURE eliminarCuenta

CREATE OR ALTER PROCEDURE eliminarCuenta
		@ID_Socio INT
AS
BEGIN
		DELETE
		FROM Facturacion.Cuenta
		WHERE ID_Socio = @ID_Socio
END;

--- 22 CREACION PROCEDURE ingresarMedioDePago

CREATE OR ALTER PROCEDURE ingresarMedioDePago
	@ID_MedioDePago INT,
	@Tipo VARCHAR(15),
AS
BEGIN
	INSERT INTO Facturacion.MedioDePago(ID_MedioDePago, Tipo) VALUES(
		@ID_MedioDePago,
		@Tipo
	)
END;

--- 23 CREACION PROCEDURE modificarMedioDePago
	
CREATE OR ALTER PROCEDURE modificarMedioDePago	
	@ID_MedioDePago INT,
	@Tipo VARCHAR(15) = NULL
AS
BEGIN
	UPDATE Facturacion.MedioDePago(Tipo) SET
		Tipo = ISNULL(@Tipo, Tipo)
	WHERE ID_MedioDePago = @ID_MedioDePago
END;

--- 24 CREACION PROCEDURE eliminarMedioDePago
	
CREATE OR ALTER PROCEDURE eliminarMedioDePago
	@ID_MedioDePago
AS
BEGIN
	DELETE
	FROM Facturacion.MedioDePago
	WHERE ID_MedioDePago = @ID_MedioDePago
END;

--- 25 CREACION PROCEDURE ingresoTarjeta
	
CREATE OR ALTER PROCEDURE ingresoTarjeta	
	@ID_MedioDePago INT,
	@NroTarjeta CHAR(19),
	@FechaVenc DATE,
	@DebitoAutomatico BIT
AS
BEGIN
	INSERT INTO Facturacion.Tarjeta(ID_MedioDePago, NroTarjeta, FechaVenc, DebitoAutomatico) VALUES(
		@ID_MedioDePago,
		@NroTarjeta,
		@FechaVenc,
		@DebitoAutomatico
	)
END;

--- 26 CREACION PROCEDURE modificarTarjeta
	@ID_MedioDePago INT,
	@NroTarjeta CHAR(19) = NULL,
	@FechaVenc DATE = NULL,
	@DebitoAutomatico BIT = NULL
AS
BEGIN
	UPDATE Facturacion.Tarjeta(NroTarjeta, FechaVenc, DebitoAutomatico) SET
		NroTarjeta = ISNULL(@NroTarjeta, NroTarjeta),
		FechaVenc = ISNULL(@FechaVenc, FechaVenc),
		DebitoAutomatico = ISNULL(@DebitoAutomatico, DebitoAutomatico)
	WHERE ID_MedioDePago = @ID_MedioDePago
END;

--- 27 CREACION PROCEDURE eliminarTarjeta

CREATE OR ALTER PROCEDURE eliminarTarjeta
	@NroTarjeta char(19)
AS
BEGIN
	DELETE
	FROM Facturacion.Tarjeta
	WHERE NroTarjeta = @NroTarjeta
END;
